---
- name: Dotfiles setup
  hosts: all
  gather_facts: true

  tasks:
    - name: Show resolved configuration
      ansible.builtin.debug:
        msg:
          hostname: "{{ ansible_hostname }}"
          username: "{{ username }}"
          git_email: "{{ git_email }}"
          theme: "{{ theme }}"
          is_desktop: "{{ is_desktop }}"
          shell: "{{ shell }}"
          editor: "{{ editor }}"

  roles:
    - packages
    - onepassword
    - lunarvim
    - shell
    - git
    - tmux
    - role: ghostty
      when: is_desktop | bool
    - role: firefox
      when: is_desktop | bool
    - role: gnome
      when: is_desktop | bool
